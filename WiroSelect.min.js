class WiroSelect{constructor(e,t){this.options={selectedClass:"wiroSelect__item--selected",slideToggleTiming:150,...t},this.select=$(e),this.selectOptions=this.select.find("option"),this._selectedname=this.select.attr("name"),this.render(),this.events()}get value(){return this._selectedvalue}get name(){return this._selectedname}get selectedIndex(){return this._selectedIndex}render(){this.select.addClass("wiroSelect__hidden"),this.createElems(),$(this.selectOptions).each((e,t)=>{const s=$('<div class="wiroSelect__item" role="option"></div>');s.text($(t).text()).attr("data-index",e).attr("data-value",$(t).val()).attr("aria-selected",$(t).is(":selected")),$(t).is(":selected")&&(s.addClass(this.options.selectedClass),this._selectBtn.text($(t).text()),this._selectedIndex=e,this._selectedvalue=$(t).val()),$(this._selectList).append(s)}),this._selectWrapper.append(this._selectBtn).append(this._selectList),$(this.select).after(this._selectWrapper)}createElems(){this._selectWrapper=$('<div class="wiroSelect"></div>'),this._selectBtn=$(`<button type="button" _selectedname="${this._selectedname}" class="wiroSelect__btn" role="button" aria-haspopup="true"></button>`),this._selectList=$('<div class="wiroSelect__list" role="select" aria-expanded="false" aria-hidden="true"></div>')}events(){if(!this._selectWrapper)return!1;this._selectWrapper.on("click",".wiroSelect__btn",e=>{this.selectToggle()}),this._selectWrapper.on("click",".wiroSelect__item",i=>{const e=$(i.target);this._selectWrapper.find(".wiroSelect__item").each((e,t)=>{$(t).removeClass(this.options.selectedClass);var s=$(t).data("index")===$(i.target).data("index");$(t).prop("ariaSelected",s)}),e.addClass(this.options.selectedClass),this._selectedvalue=e.data("_selectedvalue"),this._selectedIndex=e.data("index"),$(this.selectOptions).eq(e.data("index")).prop("selected",!0),this._selectBtn.text(e.text()),this.selectToggle()}),$(window).on("click",e=>{!$(e.target).closest(this._selectWrapper).length&&this.isSelectOpened()&&this.closeSelect()}),this._selectWrapper.on("keydown",".wiroSelect__btn",t=>{if("ArrowUp"===t.key||"ArrowDown"===t.key){t.preventDefault();var s=this._selectedIndex;let e;"ArrowUp"===t.key?e=0<s?s-1:this.selectOptions.length-1:"ArrowDown"===t.key&&(e=s<this.selectOptions.length-1?s+1:0),this.selectOptionByIndex(e)}"Escape"===t.key&&this.isSelectOpened()&&(this.closeSelect(),t.stopPropagation())}),this._selectBtn.on("blur",e=>{this.closeSelect()})}selectOptionByIndex(e){const t=this._selectWrapper.find(`[data-index="${e}"]`);t.length&&(this._selectWrapper.find(".wiroSelect__item").removeClass(this.options.selectedClass),t.addClass(this.options.selectedClass),this._selectedvalue=t.data("value"),this._selectedIndex=e,$(this.selectOptions).prop("selected",!1).eq(e).prop("selected",!0),this._selectBtn.text(t.text()),this.selectListPosition(this._selectBtn))}isSelectOpened(){return this._selectWrapper.hasClass("wiroSelect--expanded")}selectToggle(){this.isSelectOpened()?this.closeSelect():this.openSelect()}openSelect(){this._selectBtn.addClass("active"),this._selectWrapper.addClass("wiroSelect--expanded"),this.selectListPosition(),this._selectList.attr("aria-hidden",!1).attr("aria-expanded",!0).slideDown(this.options.slideToggleTiming)}closeSelect(){this._selectBtn.removeClass("active"),this._selectList.attr("aria-hidden",!0).attr("aria-expanded",!1).slideUp(this.options.slideToggleTiming,()=>{this._selectWrapper.removeClass("wiroSelect--expanded"),this.selectListPosition()})}selectListPosition(){var e=this._selectBtn.outerHeight();this._selectWrapper[0].getBoundingClientRect().bottom+this._selectList.outerHeight()<=$(window).outerHeight()?this._selectList.css({"padding-top":e+"px","padding-bottom":0,top:"5px",bottom:"auto"}):this._selectList.css({"padding-top":0,"padding-bottom":e+"px",top:"auto",bottom:"5px"})}}